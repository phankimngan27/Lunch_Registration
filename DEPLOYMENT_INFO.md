# ðŸš€ Deployment Information

## Current Deployment Setup

### Platform: Render.com

**Backend:**
- URL: https://lunch-registration.onrender.com
- Service: Web Service (Node.js)
- Region: Singapore
- Plan: Free tier
- Auto-deploy: Enabled (from `main` branch)

**Frontend:**
- URL: https://madison-lunch-frontend.onrender.com
- Service: Static Site
- Region: Singapore
- Plan: Free tier
- Auto-deploy: Enabled (from `main` branch)

**Database:**
- Provider: Neon.tech
- Region: Singapore (ap-southeast-1)
- Plan: Free tier (0.5 GB)
- Auto-suspend: After 5 minutes of inactivity

## Configuration Files

### `render.yaml`
Blueprint file for Render deployment. Contains:
- Backend service configuration
- Frontend static site configuration
- Environment variables
- Build commands
- Health check paths
- SPA routing rules

### `frontend/public/_redirects`
Fallback routing for SPA (Single Page Application):
```
/*    /index.html   200
```

### `frontend/public/render.json`
Render-specific routing configuration for static sites.

## Environment Variables

### Backend (Render)
```
NODE_ENV=production
PORT=5000
DATABASE_URL=<neon-connection-string>
JWT_SECRET=<auto-generated>
JWT_EXPIRE=7d
LUNCH_PRICE=25000
DEFAULT_PASSWORD=1234
CORS_ORIGIN=https://madison-lunch-frontend.onrender.com
```

### Frontend (Render)
```
VITE_API_URL=https://lunch-registration.onrender.com
```

## Deployment Process

### Automatic Deployment
1. Push code to `main` branch
2. GitHub webhook triggers Render
3. Render builds and deploys automatically
4. Takes ~3-5 minutes

### Manual Deployment
1. Go to Render Dashboard
2. Select service (backend or frontend)
3. Click "Manual Deploy"
4. Optional: "Clear build cache & deploy"

## Important Notes

### Free Tier Limitations
- **Backend**: Spins down after 15 minutes of inactivity
- **Database**: Auto-suspends after 5 minutes of inactivity
- **First request**: May take 5-10 seconds (cold start)
- **Subsequent requests**: Fast (<1 second)

### Performance Optimizations
- Bcrypt rounds reduced to 8 (faster login)
- Database connection pooling with keepAlive
- 30-second timeout for API requests
- Health check endpoint at `/` and `/health`

### SPA Routing
- All routes redirect to `/index.html`
- React Router handles client-side routing
- F5 refresh works on all pages

## Monitoring

### Health Checks
- Backend: `GET /health`
- Frontend: Automatic by Render

### Logs
- View in Render Dashboard â†’ Service â†’ Logs
- Real-time streaming available

## Troubleshooting

### Login slow on first request?
- Normal behavior (database cold start)
- Subsequent logins will be fast

### F5 shows "Not Found"?
- Check `render.yaml` has routes config
- Verify `_redirects` file exists in `frontend/public/`
- Try manual redeploy with cache clear

### CORS errors?
- Verify `CORS_ORIGIN` in backend env vars
- Should match frontend URL exactly

## Upgrade Options

### To eliminate cold starts:
1. **Render Starter Plan** ($7/month per service)
   - No spin down
   - Always-on instances
   
2. **Neon Pro Plan** ($19/month)
   - No auto-suspend
   - Better performance
   - More storage

## Documentation

- [Render Deployment Guide](./RENDER_DEPLOY.md)
- [Login Performance Fix](./LOGIN_PERFORMANCE_FIX.md)
- [Deploy Checklist](./DEPLOY_CHECKLIST.md)

---

**Last Updated**: October 28, 2025
**Deployed By**: Phan Kim NgÃ¢n
